This code is taken from [CoDi](https://github.com/microsoft/i-Code/tree/main/i-Code-V3).